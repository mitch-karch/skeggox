<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Skeggox</title>
        <style>
            html{
                background-color: #323336;
            }
            h3{
                color:#fff;
                font-size:x-large;
            }
            .buttons{
                display: inline-flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                
                border: solid 3px #646464;
                width: 200px;
                background-color: #323336;
                padding: 5px;
                border-radius:6px;
            }
            .outer{
                display:flex;
            }
            #preview{
                width:25%;
                height:25%;
            }

            .command {
                width:100%;
                height:17%;
                font-size: xx-large;
                border: none;
                outline: none;
                color: #fff;
                background: #111;
                cursor: pointer;
                position: relative;
                z-index: 0;
                border-radius: 10px;
                margin:6px;
            }

            .command:before {
                content: '';
                background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);
                position: absolute;
                top: -2px;
                left:-2px;
                background-size: 400%;
                z-index: -1;
                filter: blur(5px);
                width: calc(100% + 4px);
                height: calc(100% + 4px);
                animation: glowing 20s linear infinite;
                opacity: 0;
                transition: opacity .3s ease-in-out;
                border-radius: 10px;
            }

            .command:active {
                color: #000
            }

            .command:active:after {
                background: transparent;
            }

            .command:hover:before {
                opacity: 1;
            }

            .command:after {
                z-index: -1;
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                background: #111;
                left: 0;
                top: 0;
                border-radius: 10px;
            }

            @keyframes glowing {
                0% { background-position: 0 0; }
                50% { background-position: 400% 0; }
                100% { background-position: 0 0; }
            }
        </style>

        <script>
        // Only run what comes next *after* the page has loaded
        addEventListener("DOMContentLoaded", function() {
        // Grab all of the elements with a class of command
        // (which all of the buttons we just created have)
        var commandButtons = document.querySelectorAll(".command");
        for (var i=0, l=commandButtons.length; i<l; i++) {
            var button = commandButtons[i];
            // For each button, listen for the "click" event
            button.addEventListener("click", function(e) {
            // When a click happens, stop the button
            // from submitting our form (if we have one)
            e.preventDefault();

            var clickedButton = e.target;
            var command = clickedButton.value;

            // Now we need to send the data to our server
            // without reloading the page - this is the domain of
            // AJAX (Asynchronous JavaScript And XML)
            // We will create a new request object
            // and set up a handler for the response
            var request = new XMLHttpRequest();
            request.onload = function() {
                // We could do more interesting things with the response
                // or, we could ignore it entirely
                console.log(request.responseText);
                document.getElementById('preview').src=request.responseText
            };
            // We point the request at the appropriate command
            request.open("GET", "/" + command, true);
            // and then we send it off
            request.send();
            });
        }
        }, true);
        </script>

    </head>
    <body>

        <h3>Skeggox: Capture</h3>
        <div class="outer">
            <img id="bg" src="{{ url_for('video_feed') }}">

            <span class="buttons">

            {% for label, command in commands.items() %}
                <button class="command command-{{ command }}" value="{{ command }}">
                    {{ label }}
                </button>
            {% endfor %}


            </span>

        <img id='preview' src="{{ url_for('static', filename='base.jpg') }}" />
        </div>
    </body>
</html>